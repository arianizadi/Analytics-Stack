{
  "title": "Traffic Analytics (Umami)",
  "schemaVersion": 39,
  "panels": [
    {
      "type": "table",
      "title": "Top Pages",
      "gridPos": { "x": 0, "y": 0, "w": 12, "h": 8 },
      "targets": [
        {
          "datasource": { "type": "postgres", "uid": "Umami-Postgres" },
          "format": "table",
          "rawSql": "SELECT url, SUM(count) AS views FROM pageviews WHERE created_at > now() - interval '7 days' GROUP BY 1 ORDER BY 2 DESC LIMIT 50;"
        }
      ]
    },
    {
      "type": "piechart",
      "title": "Traffic by Country",
      "gridPos": { "x": 0, "y": 8, "w": 12, "h": 8 },
      "targets": [
        {
          "datasource": { "type": "postgres", "uid": "Umami-Postgres" },
          "format": "table",
          "rawSql": "SELECT country, SUM(count) AS views FROM sessions WHERE created_at > now() - interval '7 days' GROUP BY 1 ORDER BY 2 DESC LIMIT 20;"
        }
      ]
    }
  ]
}
